<html>
  <head>
    <title>GGP.org - View</title>
    <meta name="description" content="General game playing is about playing games that you've never seen before." />  
    <link rel="shortcut icon" href="http://www.ggp.org/favicon.ico">
    <link rel="stylesheet" type="text/css" href="http://fonts.googleapis.com/css?family=Droid+Sans:bold">
    <link rel="stylesheet" type="text/css" href="/viewer/bellerophon.css" />
    <script type="text/javascript" src="http://www.google.com/jsapi"></script>
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script type='text/javascript' src='//www.ggp.org/scripts/Analytics.js'></script>    
  </head>
  <body>
    <script type='text/javascript' src='//www.ggp.org/scripts/common/ResourceLoader.js'></script>
    <script type="text/javascript" src="/viewer/bellerophonHeader.js"></script>
    
    <script src="http://code.highcharts.com/highcharts.js"></script>
    <script src="http://code.highcharts.com/modules/exporting.js"></script>

    <div id='header'></div>
    <br>    
    <div id="viz1" style="min-width: 400px; height: 400px; margin: 0 auto"></div>
    <div id="viz2" style="min-width: 400px; height: 400px; margin: 0 auto"></div>
    <div id="viz3" style="min-width: 400px; height: 400px; margin: 0 auto"></div>
    <div id="viz4" style="min-width: 400px; height: 400px; margin: 0 auto"></div>
    <div id="viz5" style="min-width: 400px; height: 400px; margin: 0 auto"></div>
    <div id="viz6" style="min-width: 400px; height: 400px; margin: 0 auto"></div>
    <div id="viz7" style="min-width: 400px; height: 400px; margin: 0 auto"></div>

    <script type='text/javascript'>
      generateHeader(document.getElementById('header'));
      var expURL = 'http://database.ggp.org/logs/' + window.location.pathname.split("/")[4] + '/' + window.location.pathname.split("/")[5];      
      var cleanFloat = function (x) { return Math.round(x*100)/100; };

      function graphSeries(name, points, moves, yAxis, into) {
        var opts = {};
        opts.chart = { renderTo: into, type: 'spline' };
        opts.title = { text: name };
        //opts.subtitle = { text: 'An example of irregular time data in Highcharts JS' };
        opts.xAxis = { type: 'datetime', dateTimeLabelFormats: { month: '%e. %b', year: '%b' } };
        opts.yAxis = yAxis;
        /*
        opts.tooltip = { formatter: function() { 
          return '<b>'+ this.series.name +'</b><br/>'+
          Highcharts.dateFormat('%e. %b', this.x) +': '+ this.y +' m';
        } };
        */
        opts.series = [{
                name: name,
                data: points,
        }];
        new Highcharts.Chart(opts);
      }

      x = null;
      var x = ResourceLoader.load_json(expURL);
      if (x != null) {
        graphSeries('Planned Score', x.plannedScore, x.selectingMove, { min: 0, max: 100, title: { text: 'Score' } }, 'viz1');
        graphSeries('Expected Depth', x.expectedDepth, x.selectingMove, { min: 0, title: { text: 'Moves' } }, 'viz2');
        graphSeries('Depth Charges per Second', x.chargesPerSec, x.selectingMove, { min: 0, title: { text: 'Charges' } }, 'viz3');
        graphSeries('States Expanded per Second', x.statesPerSec, x.selectingMove, { min: 0, title: { text: 'States' } }, 'viz4');
        graphSeries('GC Time', x.gcTime, x.selectingMove, { min: 0, title: { text: 'Milliseconds' } }, 'viz5');
        graphSeries('CacheRate', x.cacheHitRate, x.selectingMove, { min: 0, max: 100, title: { text: 'Cache Hit Rate' } }, 'viz6');
        graphSeries('Memory Usage', x.memoryUsed, x.selectingMove, { min: 0, max: 10000, title: { text: 'Megabytes' } }, 'viz7');
      }
    </script>

  </body>  
</html>